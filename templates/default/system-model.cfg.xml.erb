<?xml version="1.0" encoding="UTF-8"?>

<system-model xmlns="http://docs.rackspacecloud.com/repose/system-model/v2.0">
    <repose-cluster id="<%= @cluster_id %>">
        <nodes>
            <% @peers.each do |peer| %>
            <node id="<%= peer['id'] %>" hostname="<%= peer['hostname'] %>" http-port="<%= peer['port'] %>" />
            <% end %>
        </nodes>
        <filters>
            <% @filters.each do |filter| %>
            <filter name="<%= filter %>" />
            <% end %>
        </filters>
        <services>
            <% @services.each do |service| %>
            <service name="<%= service %>" />
            <% end %>
        </services>
        <destinations>
            <% @endpoints.each do |endpoint| %>
            <endpoint id="<%= endpoint['id'] %>" protocol="<%= endpoint['protocol'] %>" hostname="<%= endpoint['hostname'] %>" port="<%= endpoint['port'] %>" root-path="<%= endpoint['root_path'] %>" default="<%= endpoint['default'] %>" />
            <% end %>
        </destinations>
    </repose-cluster>
</system-model>
